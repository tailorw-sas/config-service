# ===============================================
# COMMON DLQ CONFIGURATION - TODOS LOS MICROSERVICIOS
# ===============================================

# DLQ Database (centralizado)
spring.datasource.dlq.url=${KAFKA_DB_HOST_RW}
spring.datasource.dlq.username=${KAFKA_DB_USER_RW}
spring.datasource.dlq.password=${KAFKA_DB_PASSWORD_RW}
spring.datasource.dlq.driver-class-name=org.postgresql.Driver

# ===============================================
# HIKARI POOLS - OPTIMIZADO PARA MÚLTIPLES MICROS
# ===============================================

# DataSource Principal (Write)
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# DataSource Lectura (Read)
spring.read-datasource.hikari.maximum-pool-size=5
spring.read-datasource.hikari.minimum-idle=1
spring.read-datasource.hikari.connection-timeout=20000
spring.read-datasource.hikari.idle-timeout=300000
spring.read-datasource.hikari.max-lifetime=1200000

# DLQ DataSource (kafka-enterprise-lib)
spring.datasource.dlq.hikari.maximum-pool-size=3
spring.datasource.dlq.hikari.minimum-idle=1
spring.datasource.dlq.hikari.connection-timeout=20000
spring.datasource.dlq.hikari.idle-timeout=300000
spring.datasource.dlq.hikari.max-lifetime=1200000
spring.datasource.dlq.hikari.pool-name=DLQHikariPool

# DLQ Configuration
finamer.kafka.dlq.enabled=true
finamer.kafka.dlq.suffix=.DLT
finamer.kafka.dlq.max-retries=3
finamer.kafka.dlq.retry-delay=1s
finamer.kafka.dlq.auto-create-topics=true
finamer.kafka.dlq.enable-batch-reprocessing=true

# Redis (idempotencia)
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.timeout=2000ms
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=2

# Flyway (deshabilitado - la lib lo maneja)
spring.flyway.enabled=false

# Idempotency común
finamer.kafka.idempotency.enabled=true
finamer.kafka.idempotency.ttl=24h
